# 정산 시스템 및 대용량 데이터 처리 구현 방법

## 1. CashMember 도입

- [CashMember](src\01_CashMember\CashMember.java) : Cash 테이블에 있는 Member 관련 데이터를 별도의 CashMember 테이블로 분리하여 관리
- [CashMemberRepository](src\01_CashMember\CashMemberRepository.java) : CashMember 데이터 접근 및 관리
- [CashEventListener](src\01_CashMember\CashEventListener.java) : Member 관련 이벤트 발생 시 CashMember 업데이트 처리
- [CashFacade](src\01_CashMember\CashFacade.java) : CashMember와 Member 데이터 동기화

## 2. Wallet 도입 (CashWallet)

- [BaseManualIdAndTime](src\02_CashWallet\base\BaseManualIdAndTime.java) : 수동 ID 및 생성/수정 시간 관리를 위한 베이스 클래스
- [Wallet](src\02_CashWallet\Wallet.java) : CashMember와 1:1 관계인 지갑 생성
    - CashMember에 wallet 필드를 추가하지 않은 이유: 지갑은 추후 비관적인 락을 걸어서 가져와야 하는 경우가 있을 수 있기 때문에
- [WalletRepository](src\02_CashWallet\WalletRepository.java) : Wallet 데이터 접근 및 관리
- [CashEventListener](src\02_CashWallet\CashEventListener.java) : MemberJoinedEvent 발생 시 Wallet 생성 처리
- [CashFacade](src\02_CashWallet\CashFacade.java) : createWallet 메서드 추가

## 3. Cash 관련 데이터 초기화
- [Wallet](src\03_CashDataInit\Wallet.java) : Wallet에는 현재 상태인 balance 필드만 존재
- [CashLog](src\03_CashDataInit\CashLog.java) : Cash 변경 이력을 기록하는 CashLog 엔티티 추가
- [CashFacade](src\03_CashDataInit\CashFacade.java) : findMemberByUserName(), findWalletByHoder() 메서드 추가
- [CashDataInit](src\03_CashDataInit\CashDataInit.java) : Wallet 초기화
- [WalletRepository](src\03_CashDataInit\WalletRepository.java) : findByHolder() 메서드 추가

## 4. Cash 모듈 리팩토링

### Facade에 직접 구현된 기능들을 UseCase로 분리

* [CashFacade](src\04_Cash_Refactoring\CashFacade.java) : 구현로직 없이 유즈케이스 호출로 구성

* UseCase : 비즈니스 로직 구현
  * [CashCreateWalletUseCase](src\04_Cash_Refactoring\CashCreateWalletUseCase.java) : 지갑 생성 유즈케이스
  * [CashSyncMemberUseCase](src\04_Cash_Refactoring\CashSyncMemberUseCase.java) : 멤버 동기화 유즈케이스  

* [CashSupport](src\04_Cash_Refactoring\usecase\CashSupport.java) : UseCase에서 중복되는 코드인 findBy 메서드 모음

### CashEventListener에 있는 비지니스 로직을 이벤트를 사용하여 제거

- [CashMemberDto](src\04_Cash_Refactoring\CashMemberDto.java) : CashMember 관련 DTO
- [CashMemberCreatedEvent](src\04_Cash_Refactoring\CashMemberCreatedEvent.java) : CashMember 생성 이벤트
- [CashSyncMemberUseCase](src\04_Cash_Refactoring\CashSyncMemberUseCase.java) : CashMember 생성 후 CashMemberCreatedEvent 발행
- [CashEventListener](src\04_Cash_Refactoring\CashEventListener.java) : CashMemberCreatedEvent 리스너 추가
- [CashFacade](src\04_Cash_Refactoring\CashFacade.java) : CashMember를 CashMemberDto로 변환
- [CashCreateWalletUseCase](src\04_Cash_Refactoring\CashCreateWalletUseCase.java) : CashMemberCreatedEvent 수신 후 Wallet 생성

## 5. Post 모듈 리팩토링 - Facade에 직접 구현된 기능들을 UseCase로 분리

- [PostFacade](src\05_Post_Refactoring\PostFacade.java) : 구현로직 없이 유즈케이스 호출로 구성
- [PostSyncMemberUseCase](src\05_Post_Refactoring\PostSyncMemberUseCase.java) : Post 모듈에서 Member 동기화 유즈케이스
- [PostSupport](src\05_Post_Refactoring\PostSupport.java) : UseCase에서 중복되는 메서드 모음

## 6. Member 모듈 리팩토링 - Facade에 직접 구현된 기능들을 UseCase로 분리

- [MemberFacade](src\06_Member_Refactoring\MemberFacade.java) : 구현로직 없이 유즈케이스 호출로 구성
- [MemberGetRandomSecureTipUseCase](src\06_Member_Refactoring\MemberGetRandomSecureTipUseCase.java) : Member 모듈에서 랜덤 보안 팁 조회 유즈케이스
- [MemberSupport](src\06_Member_Refactoring\MemberSupport.java) : UseCase에서 중복되는 메서드 모음


## 7. Market 모듈 추가 - MarketMember 구현

- [MarketMember](src\07_MarketModule\MarketMember.java) : Market 모듈에서 Member 관련 데이터 관리
- [MarketMemberRepository](src\07_MarketModule\MarketMemberRepository.java) : MarketMember 데이터 접근 및 관리
- [MarketEventListener](src\07_MarketModule\MarketEventListener.java) : Member 관련 이벤트 발생 시 MarketMember 업데이트 처리
- [MarketFacade](src\07_MarketModule\MarketFacade.java) : MarketSyncMemberUseCase 호출
- [MarketSyncMemberUseCase](src\07_MarketModule\MarketSyncMemberUseCase.java) : Market 모듈에서 Member 동기화 유즈케이스

## 8. 글 조회를 위해서 PostApiClient 구현

- [PostApiClient](src\08_PostApiClient\PostApiClient.java) : Post 모듈의 글 조회 API 클라이언트
- [PostDto](src\08_PostApiClient\PostDto.java) : Post 모듈의 글 관련 DTO
- [PostFacade](src\08_PostApiClient\PostFacade.java) : findByOrderByIdDesc() 메서드 추가
- [PostSupport](src\08_PostApiClient\PostSupport.java) : findByOrderByIdDesc() 메서드 추가
- [PostRepository](src\08_PostApiClient\PostRepository.java) : findByOrderByIdDesc() 메서드 추가
- [MarketDataInit](src\08_PostApiClient\MarketDataInit.java) : Market 모듈에서 PostApiClient를 사용하여 글 데이터 초기화
- [ApiV1PostController](src\08_PostApiClient\ApiV1PostController.java) : 글 조회 API 구현